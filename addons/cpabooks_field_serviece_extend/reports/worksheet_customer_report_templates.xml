<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <template id="inherit_worksheet_custom_page_jcr" inherit_id="industry_fsm_report.worksheet_custom_page">
            <xpath expr="//div[contains(@class, 'page')]" position="replace">
                <div class="page" style="font-size: 14px; color: black; font-family: Arial, sans-serif;">

                    <!-- Header -->
                    <div style="text-align: center; margin-bottom: 10px;">
                        <div style="font-size: 20px; font-weight: bold;">JOB COMPLETION REPORT</div>
                    </div>

                    <div style="width: 100%; overflow: hidden; margin-bottom: 10px; border-bottom: 1px solid black;">

                        <!-- Left Section -->
                        <div style="float: left; width: 70%;">
                            <strong>CRN / JCR No :</strong>
                            <span t-field="doc.task_seq" style="margin-left: 6px;"/>
                        </div>

                        <!-- Right Section -->
                        <div style="float: right; width: 30%; text-align: right;">
                            <strong>Creation Date :</strong>
                            <span t-field="doc.assign_date"
                                  t-options="{'widget': 'date'}"
                                  style="margin-left: 6px;"/>
                        </div>

                    </div>


                    <!-- Customer Details -->
                    <div style="margin-bottom: 12px;">

                        <!-- Section Title -->
                        <div style="font-weight: bold; font-size: 15px; margin-bottom: 5px;">
                            Customer Details :
                        </div>

                        <div style="width: 100%; overflow: hidden; border-bottom: 1px solid black; padding: 4px 0;">
                            <div style="float: left; width: 60%;">
                                <strong>Customer Name :</strong>
                                <span t-field="doc.partner_id.name" style="margin-left: 8px;"/>
                            </div>
                            <div style="float: right; width: 40%;">
                                <strong>Contact No :</strong>
                                <span style="display: inline-block; min-width: 150px; margin-left: 8px;">
                                    <t t-esc="doc.client_contact or ''"/>
                                </span>
                            </div>
                        </div>

                        <!-- Row 2 -->
                        <div style="width: 100%; overflow: hidden; border-bottom: 1px solid black; padding: 4px 0;">
                            <div style="float: left; width: 60%;">
                                <strong>Contact Person :</strong>
                                <span t-field="doc.client_person.name" style="margin-left: 6px;"/>
                            </div>
                            <div style="float: right; width: 40%;">
                                <strong>Email :</strong>
                                <span t-field="doc.client_email" style="margin-left: 6px;"/>
                            </div>
                        </div>

                        <!-- Row 3 Full Width -->
                        <div style="width: 100%; border-bottom: 1px solid black; padding: 4px 0;">
                            <strong>Site Address :</strong>
                            <span t-field="doc.site_location.name" style="margin-left: 6px;"/>
                        </div>

                        <!-- Row 4 -->
                        <div style="width: 100%; overflow: hidden; border-bottom: 1px solid black; padding: 4px 0;">
                            <div style="float: left; width: 60%;">
                                <strong>Complaint / Job Type :</strong>
                                <span t-field="doc.complaint_type" style="margin-left: 6px;"/>
                            </div>
                            <div style="float: right; width: 40%;">
                                <strong>Ref Invoice / Qtn :</strong>
                                <span style="margin-left: 6px;">
                                    <t t-if="doc.invoice_id">
                                        <t t-esc="doc.invoice_id.name"/>
                                    </t>
                                    <t t-elif="doc.qt_no">
                                        <t t-esc="doc.qt_no.name"/>
                                    </t>
                                </span>
                            </div>
                        </div>

                        <!-- Row 5 Full Width -->
                        <div style="width: 100%; border-bottom: 1px solid black; padding: 4px 0;">
                            <strong>Equipment Details :</strong>
                            <span t-field="doc.item_des.name" style="margin-left: 6px;"/>
                        </div>

                        <!-- Row 6 Full Width -->
                        <div style="width: 100%; border-bottom: 1px solid black; padding: 4px 0;">
                            <strong>Type of Service :</strong>
                            <span t-field="doc.complaint_type" style="margin-left: 6px;"/>
                        </div>

                    </div>


                    <!-- Complaint / Job Details -->
                    <div style="margin-bottom: 14px;">
                        <div style="font-weight: bold; font-size: 15px; margin-bottom: 4px;">Complaint / Job Details :
                        </div>
                        <div style="border: 1px solid black; min-height: 80px; padding: 8px;">
                            <span t-field="doc.complaint_details"/>
                        </div>
                    </div>

                    <!-- Parts / Materials Used -->
                    <div style="margin-bottom: 14px;">
                        <div style="font-weight: bold; text-decoration: underline; margin-bottom: 4px;">Parts /
                            Materials Used:
                        </div>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <thead>
                                <tr style="background-color: #f0f0f0;">
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 8%;">SR
                                        No.
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center;">Particulars
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 18%;">
                                        Serial No.
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 10%;">
                                        QTY
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Filled rows from material lines -->
                                <t t-foreach="doc.material_line_ids" t-as="line">
                                    <tr>
                                        <td style="border: 1px solid black; padding: 5px; text-align: center;">
                                            <t t-esc="line_index + 1"/>
                                        </td>
                                        <td style="border: 1px solid black; padding: 5px;">
                                            <t t-esc="line.product_id.name"/>
                                        </td>
                                        <td style="border: 1px solid black; padding: 5px;">
                                            <t t-esc="line.serial_no or ''"/>
                                        </td>
                                        <td style="border: 1px solid black; padding: 5px; text-align: center;">
                                            <t t-esc="line.quantity"/>
                                        </td>
                                    </tr>
                                </t>
                                <!-- Empty rows to fill up to total_print_row -->
                                <t t-set="filled_rows" t-value="len(doc.material_line_ids)"/>
                                <t t-set="empty_rows"
                                   t-value="doc.total_print_row - filled_rows if doc.total_print_row > filled_rows else 0"/>
                                <t t-foreach="range(empty_rows)" t-as="i">
                                    <tr>
                                        <td style="border: 1px solid black; padding: 5px; text-align: center;">
                                            <t t-esc="filled_rows + i + 1"/>
                                        </td>
                                        <td style="border: 1px solid black; padding: 5px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 5px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 5px;">&#160;</td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- Time Sheet -->
                    <div style="margin-bottom: 14px;">
                        <div style="font-weight: bold; text-decoration: underline; margin-bottom: 4px;">Time Sheet:
                        </div>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <thead>
                                <tr style="background-color: #f0f0f0;">
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 20%;">
                                        Date
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center;">Service Eng /
                                        Technician
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 15%;">
                                        Time In
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 15%;">
                                        Time Out
                                    </th>
                                    <th style="border: 1px solid black; padding: 5px; text-align: center; width: 15%;">
                                        Hrs. Worked
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="range(4)" t-as="i">
                                    <tr>
                                        <td style="border: 1px solid black; padding: 8px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 8px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 8px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 8px;">&#160;</td>
                                        <td style="border: 1px solid black; padding: 8px;">&#160;</td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>

                    <!-- Details of Handover -->
                    <div style="margin-bottom: 14px;">
                        <div style="font-weight: bold; text-decoration: underline; margin-bottom: 6px;">Details of
                            Handover:
                        </div>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                            <tr>
                                <!-- Customer Side -->
                                <td style="width: 60%; vertical-align: top; padding: 8px; border-right: 1px solid black;">
                                    <p style="margin: 0 0 10px 0;">
                                        The Service Engineer has Installed/ Serviced/ repaired the Equipment to our
                                        Satisfaction and we agreed to pay below mentioned Charges
                                    </p>
                                    <p style="margin: 6px 0;">
                                        Invoice / Qtn : ......................................
                                        <span style="margin-left: 20px;">Amount AED........................</span>
                                    </p>
                                    <p style="margin: 6px 0;">Customer Name :
                                        ................................................... Mob :
                                        ..........................
                                    </p>
                                    <p style="margin: 6px 0;">Signature:
                                        .................................................... Date :
                                        .....................................
                                    </p>
                                </td>
                                <!-- World Connect Side -->
                                <td style="width: 40%; vertical-align: top; padding: 8px;">
                                    <p style="margin: 0 0 6px 0;">
                                        <strong>
                                            <em>For World Connect</em>
                                        </strong>
                                    </p>
                                    <p style="margin: 6px 0;">
                                        Service Eng Name :
                                        <span t-field="doc.visited_by.name"
                                              style="border-bottom: 1px solid black; display: inline-block; min-width: 140px;"/>
                                    </p>
                                    <p style="margin: 6px 0;">
                                        Service Eng. Sign: ................................
                                        <br/>
                                        <span>Date : ..........................</span>
                                    </p>

                                    <p style="margin: 10px 0 4px 0;">
                                        <strong>Remarks :</strong>
                                    </p>
                                    <p style="margin: 0; border-bottom: 1px solid black; min-height: 20px;">
                                        <span t-field="doc.close_remarks"/>
                                    </p>
                                    <p style="margin: 6px 0; border-bottom: 1px solid black; min-height: 20px;">&#160;
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </div>

                </div>
            </xpath>
        </template>
    </data>
</odoo>