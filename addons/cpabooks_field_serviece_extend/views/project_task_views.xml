<?xml version="1.0" encoding="UTF-8" ?>

<odoo>
    <data>

        <record id="fsm_project_task_tree_inherit" model="ir.ui.view">
            <field name="name">fsm.project.task.tree.inherit</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm.project_task_view_list_fsm"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='name']" position="before">
                    <field name="create_date" string="Create Date" widget="date"
                           invisible="not context.get('fsm_mode',False)"/>
                    <field name="task_seq" string="CRN No" invisible="not context.get('fsm_mode',False)"/>
                </xpath>
                <xpath expr="//field[@name='name']" position="after">
                    <field name="complaint_details" invisible="not context.get('fsm_mode',False)" optional="hide"/>
                    <field name="client_person" invisible="not context.get('fsm_mode',False)" optional="hide"/>
                    <field name="client_contact" invisible="not context.get('fsm_mode',False)" optional="hide"/>
                    <field name="client_email" invisible="not context.get('fsm_mode',False)" optional="hide"/>
                    <field name="complaint_type" invisible="not context.get('fsm_mode',False)" optional="hide"/>
                    <field name="stage" invisible="not context.get('fsm_mode',False)"/>
                </xpath>
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="site_location" string="Site Address" invisible="not context.get('fsm_mode',False)"/>
                </xpath>

                <xpath expr="//field[@name='company_id']" position="before">
                    <field name="approved_by" invisible="not context.get('fsm_mode',False)"/>
                </xpath>



            </field>
        </record>


        <record id="view_fsm_project_task_form_view_inherit_project" model="ir.ui.view">
            <field name="name">view.fsm.project.task.form.view.inherit.project</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2"/>
            <field name="arch" type="xml">
                <xpath expr="//notebook/page[@name='description_page']" position="after">
                    <page string="Material Request">
                        <group>
                            <field name="material_line_ids" nolabel="1">
                                <tree editable="bottom">
                                    <field name="product_id"/>
                                    <field name="description"/>
                                    <field name="quantity"/>
                                </tree>
                            </field>
                        </group>
                    </page>

                </xpath>

            </field>
        </record>

         <record id="view_fsm_project_task_form_view_inherit" model="ir.ui.view">
            <field name="name">view.fsm.project.task.list.view.inherit</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="cpabooks_project_extend.project_view_task_form2_inherit_project_extend"/>
            <field name="arch" type="xml">


                <xpath expr="//field[@name='task_seq']" position="after">
                    <field name="task_seq" string="CRN Number" readonly="1"
                           invisible="not context.get('fsm_mode',False)"/>
                    <field name="create_date" string="Create Date" readonly="1" widget="date"
                           invisible="not context.get('fsm_mode',False)"/>
                    <field name="partner_id" invisible="not context.get('fsm_mode',False)"/>
                    <field name="site_location" invisible="not context.get('fsm_mode',False)"/>
                    <field name="project_id" invisible="not context.get('fsm_mode',False)"/>
                    <field name="client_person" invisible="not context.get('fsm_mode',False)"/>
                    <field name="client_email" string="Client Email" widget="email"
                           invisible="not context.get('fsm_mode',False)"/>
                    <field name="client_contact" widget="phone" invisible="not context.get('fsm_mode',False)"/>
                    <field name="complaint_type" invisible="not context.get('fsm_mode',False)"/>
                    <field name="invoice_id"
                           attrs="{'invisible': [('complaint_type', 'not in', ('warranty_service','amc'))]}" domain="[('move_type', '=', 'out_invoice'), ('partner_id', '=', partner_id), ('state', '=', 'posted')]"/>
                    <field name="item_des"
                           attrs="{'invisible': [('complaint_type', 'not in', ('warranty_service','amc'))]}"/>
                    <field name="qt_no"
                           attrs="{'invisible': [('complaint_type', '!=', 'new_installation')]}"/>
                    <field name="crn_done_before" invisible="not context.get('fsm_mode',False)"/>
                    <field name="name" string="Complaint Title" invisible="not context.get('fsm_mode',False)"/>
                    <field name="complaint_details" invisible="not context.get('fsm_mode',False)"/>
                    <field name="total_print_row" invisible="not context.get('fsm_mode',False)"/>
                </xpath>
                <xpath expr="//field[@name='task_group_id']" position="after">
                    <field name="stage" invisible="not context.get('fsm_mode',False)"/>
                    <div>
                        <span invisible="not context.get('fsm_mode',False)">i. Site Visit</span>
                    </div>
                    <field name="work_completion" invisible="1"/>
                    <field name="next_action" invisible="1"/>
                    <field name="work_completion" invisible="1"/>
                    <field name="visited_by" invisible="not context.get('fsm_mode',False)"
                           attrs="{'readonly': ['|',('next_action', '!=', False),('work_completion', '=', 'invoiced')]}"/>
                    <field name="visited_date" invisible="not context.get('fsm_mode',False)"/>
                    <field name="site_visit" invisible="not context.get('fsm_mode',False)"/>
                    <field name="next_action" string="ii. Next Action (after site visit): "
                           invisible="not context.get('fsm_mode',False)"
                           attrs="{'readonly': [('work_completion', '!=', False)]}"/>
                    <field name="user_id" invisible="not context.get('fsm_mode',False)"
                           attrs="{'invisible': [('next_action', '=', 'closed')]}"/>
                    <field name="assign_date" invisible="not context.get('fsm_mode',False)"
                           attrs="{'invisible': [('next_action', '=', 'closed')]}"/>
                    <field name="date_end" invisible="not context.get('fsm_mode',False)"/>
                    <field name="work_completion" invisible="not context.get('fsm_mode',False)"
                           attrs="{'invisible': [('next_action', '=', 'closed')]}"/>
                    <field name="select_invoice" invisible="not context.get('fsm_mode',False)"
                           attrs="{'invisible': [('work_completion', '!=', 'invoiced')]}" domain="[
                                                   ('move_type', '=', 'out_invoice'),
                                                   ('partner_id', '=', partner_id),
                                                   ('state', '=', 'posted')
                                               ]"/>
                    <field name="tag_ids" widget="many2many_tags"
                           options="{'color_field': 'color', 'no_create_edit': True}"/>
                    <field name="closing_remarks"/>
                    <field name="approved_by"/>
                </xpath>

            </field>
         </record>

        <!-- TREE -->
        <record id="industry_fsm.project_task_action_fsm_view_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="5"/>
        </record>

        <!-- KANBAN -->
        <record id="industry_fsm.project_task_action_fsm_view_kanban" model="ir.actions.act_window.view">
            <field name="sequence" eval="10"/>
        </record>

        <!-- MAP -->
        <record id="industry_fsm.project_task_action_fsm_view_map" model="ir.actions.act_window.view">
            <field name="sequence" eval="15"/>
        </record>

        <!-- CALENDAR -->
        <record id="industry_fsm.project_task_action_fsm_view_calendar" model="ir.actions.act_window.view">
            <field name="sequence" eval="20"/>
        </record>

        <!-- FORM -->
        <record id="industry_fsm.project_task_action_fsm_view_form" model="ir.actions.act_window.view">
            <field name="sequence" eval="30"/>
        </record>

        <record id="project_task_view_list_fsm_report_inherit" model="ir.ui.view">
            <field name="name">project.task.tree.fsm.report.inherit</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="industry_fsm_report.project_task_view_list_fsm_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='worksheet_template_id']" position="attributes">
                     <attribute name="optional">hide</attribute>
                </xpath>
            </field>
        </record>


    </data>
</odoo>