<?xml version="1.0" encoding="UTF-8"?>
<odoo>
   <template id="template_print_crm_lead_opportunity_document">
      <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
      <t t-call="web.external_layout">
         <div class="page">
            <div class="oe_structure" />
            <div class="col-sm-12" align="center" style="padding-top:5px;">
               <table width="100%" style="border-collapse:separate;border-spacing:0 10px;cellspacing:0px;">
                  <p>
                     <h3>
                        <span t-if="doc.type == 'lead' or doc.type== False">
                           Leads #
                           <span t-if="doc.name" t-field="doc.name" />
                        </span>
                        <span t-if="doc.type == 'opportunity'">
                           Opportunity #
                           <span t-if="doc.name" t-field="doc.name" />
                        </span>
                     </h3>
                  </p>
                  <br />
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Customer :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-field="doc.partner_id" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Email :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.email_from" t-field="doc.email_from" />
                     </td>
                  </tr>
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Phone :</td>
                     <td t-if="doc.type == 'lead' or doc.type== False" width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.phone" t-field="doc.phone" />
                     </td>
                     <td t-if="doc.type == 'opportunity'" width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.phone" t-field="doc.phone" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Mobile :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.mobile" t-field="doc.mobile" />
                     </td>
                  </tr>
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Website :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.website" t-field="doc.website" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">
                        <span t-if="doc.type == 'lead' or doc.type== False">Company Name:</span>
                        <span t-if="doc.type == 'opportunity'">Customer Name:</span>
                     </td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.partner_name" t-field="doc.partner_name" />
                     </td>
                  </tr>
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Salesperson :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.user_id" t-field="doc.user_id" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Contact Name :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.title" t-field="doc.title" />
                        <span t-if="doc.contact_name" t-field="doc.contact_name" />
                        <span t-if="doc.function">
                           (
                           <span t-field="doc.function" />
                           )
                        </span>
                     </td>
                  </tr>
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Sales Channel :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.team_id" t-field="doc.team_id" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Address :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <t t-if="doc.street">
                           <span t-field="doc.street" />
                        </t>
                        <t t-if="doc.street2">
                           <span t-field="doc.street2" />
                        </t>
                        <t t-if="doc.city">
                           <span t-field="doc.city" />
                        </t>
                        <t t-if="doc.state_id">
                           <span t-field="doc.state_id" />
                        </t>
                        <t t-if="doc.zip">
                           <span t-field="doc.zip" />
                        </t>
                        <t t-if="doc.country_id">
                           <span t-field="doc.country_id" />
                        </t>
                     </td>
                  </tr>
                  <tr t-if="doc.type == 'opportunity'">
                     <td width="25%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Exp. Revenue :</td>
                     <td width="25%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.expected_revenue" t-field="doc.expected_revenue" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Probability :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.probability" t-field="doc.probability" />
                        <strong>%</strong>
                     </td>
                  </tr>
                  <tr>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Priority :</td>
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.priority" t-field="doc.priority" />
                     </td>
                     <td t-if="doc.type == 'opportunity'" width="25%" align="left" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Expected Closing :</td>
                     <td t-if="doc.type == 'opportunity'" width="25%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.date_deadline" t-field="doc.date_deadline" />
                     </td>
                  </tr>
               </table>
               <div>
                  <span align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Marketing Details</span>
                  <br />
                  <br />
               </div>
               <table width="100%" class="table table-bordered">
                  <tr>
                     <td width="30%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Campaign</td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Medium</td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Source</td>
                     <td width="30%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Referred By</td>
                  </tr>
                  <tr>
                     <td width="30%" align="center" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.campaign_id" t-field="doc.campaign_id" />
                     </td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.medium_id" t-field="doc.medium_id" />
                     </td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.source_id" t-field="doc.source_id" />
                     </td>
                     <td width="30%" align="center" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="doc.referred" t-field="doc.referred" />
                     </td>
                  </tr>
               </table>
               <div t-if="doc.type == 'opportunity'">
                  <span align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Meeting Details</span>
                  <br />
                  <br />
               </div>
               <table width="100%" class="table table-bordered" t-if="doc.type == 'opportunity'">
                  <tr>
                     <td width="30%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Subject</td>
                     <td width="12%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Start Date</td>
                     <td width="12%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">End Date</td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Attendees</td>
                     <td width="20%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Location</td>
                     <td width="6%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Duration</td>
                  </tr>
                  <tr t-foreach="doc.calendar_meeting_ids" t-as="meetings">
                     <td width="30%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="meetings" t-field="meetings.name" />
                     </td>
                     <td width="12%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="meetings" t-esc="time.strftime('%d/%m/%Y',time.strptime(str(meetings.start),'%Y-%m-%d %H:%M:%S'))" />
                     </td>
                     <td width="12" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="meetings" t-esc="time.strftime('%d/%m/%Y',time.strptime(str(meetings.stop),'%Y-%m-%d %H:%M:%S'))" />
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <t t-if="meetings and meetings.partner_ids">
                           <t t-set="reg" t-value="0" />
                           <t t-foreach="meetings.partner_ids" t-as="partner">
                              <span t-if="reg==1">,</span>
                              <span t-if="partner" t-field="partner.name" />
                              <t t-set="reg" t-value="1" />
                           </t>
                        </t>
                     </td>
                     <td width="20%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="meetings" t-field="meetings.location" />
                     </td>
                     <td width="6%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="meetings" t-field="meetings.duration" />
                     </td>
                  </tr>
               </table>
               <div t-if="doc.type == 'opportunity'">
                  <span align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Quotation Details</span>
                  <br />
                  <br />
               </div>
               <table width="100%" class="table table-bordered" t-if="doc.type == 'opportunity'">
                  <tr>
                     <td width="12%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Sale Order</td>
                     <td width="12%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Order Date</td>
                     <td width="22%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Customer</td>
                     <td width="22%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Salesperson</td>
                     <td width="15%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">Total</td>
                     <td width="12%" align="center" style="font-family: 'Helvetica';font-size: 16px;font-weight:bold;">State</td>
                  </tr>
                  <tr t-foreach="doc.sale_quotation_ids" t-as="quotation">
                     <td width="12%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-field="quotation.name" />
                     </td>
                     <td width="12%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-esc="time.strftime('%d/%m/%Y',time.strptime(str(quotation.date_order),'%Y-%m-%d %H:%M:%S'))" />
                     </td>
                     <td width="22%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-field="quotation.partner_id" />
                     </td>
                     <td width="22%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-field="quotation.user_id" />
                     </td>
                     <td width="15%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-field="quotation.amount_total" />
                     </td>
                     <td width="12%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <span t-if="quotation" t-field="quotation.state" />
                     </td>
                  </tr>
               </table>
               <br />
               <table width="100%">
                  <tr>
                     <td width="100%" align="left" style="font-family: 'Helvetica';font-size: 16px;">
                        <strong>Internal Notes :</strong>
                        <span t-if="doc.description" t-field="doc.description" />
                     </td>
                  </tr>
               </table>
            </div>
         </div>
      </t>
   </template>

   <template id="template_print_crm_lead_opportunity">
      <t t-call="web.html_container">
         <t t-foreach="docs" t-as="doc">
            <t t-call="sh_print_lead.template_print_crm_lead_opportunity_document" t-lang="doc.partner_id.lang" />
         </t>
      </t>
   </template>

   <record id="report_print_crm_lead_opportunity" model="ir.actions.report">
      <field name="name">Print Lead/Opportunity</field>
      <field name="model">crm.lead</field>
      <field name="report_type">qweb-pdf</field>
      <field name="report_name">sh_print_lead.template_print_crm_lead_opportunity</field>
      <field name="report_file">sh_print_lead.template_print_crm_lead_opportunity</field>
      <field name="binding_model_id" ref="crm.model_crm_lead" />
      <field name="binding_type">report</field>
   </record>
</odoo>
